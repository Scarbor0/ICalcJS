var v=Object.defineProperty;var f=(n,e,t)=>e in n?v(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var l=(n,e,t)=>(f(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();class d{constructor(e,t){l(this,"$btns");l(this,"limitNumbers");l(this,"$primaryScreen");l(this,"$operationsScreen");l(this,"varResult");l(this,"varOperationResult");l(this,"symbolsNumRegex");l(this,"symbolsMathRegex");l(this,"equalResult");l(this,"countHistoryResults");l(this,"mPlusMemory");l(this,"countAC");this.$btns=document.querySelector(e),this.limitNumbers=t.limitNumbers,this.$primaryScreen=document.querySelector("#primary-screen"),this.$operationsScreen=document.querySelector("#operations-screen"),this.varResult=[],this.varOperationResult=[],this.equalResult=null,this.countHistoryResults=0,this.symbolsNumRegex=/[0-9.,\-$]/,this.symbolsMathRegex=/^[÷×\–+]$/,this.mPlusMemory=null,this.countAC=0}fnLastHistoryScreen(){return document.querySelector("#operations-screen span:last-child")}cleraAllScrean(){this.fnLastHistoryScreen().innerHTML="<span></span>",this.$primaryScreen.innerText=""}clearAll(){this.varResult=[],this.varOperationResult=[],this.countHistoryResults=0,this.equalResult=null,!this.varResult[0]&&!this.varOperationResult[0]&&this.cleraAllScrean()}onlyOneDot(){this.varResult[0]&&(this.varResult[this.varResult.length-1]=this.varResult[this.varResult.length-1].replace(/[^.\d-]+/g,"").replace(/^([^\.]*\.)|\./g,"$1"))}clickBtns(){var e;return(e=this.$btns)==null||e.addEventListener("click",t=>{if(t.target){const r=t.target,s=r.dataset;if(r.closest(".button")){if(this.delLastNumber(s),console.log(this.varOperationResult),console.log(this.varOperationResult[this.varOperationResult.length-1]),console.log("this.varResult",this.varResult),console.error("this.equalResult",this.equalResult),console.error("TYPE this.equalResult",typeof this.equalResult),s.number){if(this.varResult[0]&&this.varResult[this.varResult.length-1].length>=this.limitNumbers&&s.number!=="-")return;//! LIMIT NUMBERS!!!!
//! Bnts Number
switch(!0){case this.symbolsNumRegex.test(this.varResult[this.varResult.length-1]):this.varResult[this.varResult.length-1]+=s.number,this.varOperationResult[this.varOperationResult.length-1]+=s.number;break;case(!this.varResult[0]||this.symbolsMathRegex.test(this.varResult[this.varResult.length-1])):this.varResult.push(s.number),this.varOperationResult.push(s.number);break}this.onlyOneDot(),console.warn("this.equalResult",this.equalResult)}if(s.math){//! Bnts Math Symbols
if(this.equalResult&&!this.varResult[0]){//! 999 999 + 999 999 = res + ...
this.varOperationResult.push(this.addSpacesToNumber(this.equalResult)),this.varResult.push(this.equalResult)}this.symbolsMathRegex.test(this.varResult[this.varResult.length-1])?(this.varResult[this.varResult.length-1]=s.math,this.varOperationResult[this.varOperationResult.length-1]=s.math):this.symbolsNumRegex.test(this.varResult[this.varResult.length-1])&&(this.varResult.push(s.math),this.varOperationResult.push(s.math))}s.equal==="="&&this.equalLastNum(),this.allFormatNumberForDisplay(s),this.btnMplus(s),this.mClear(s),this.clearScreens(s),this.mScreenStyles(),this.renderScreen(s),this.mRecall(s),!this.varResult[0]&&this.equalResult&&(this.$primaryScreen.innerText=this.addSpacesToNumber(this.equalResult)),this.varResult[0]&&(this.equalResult=null),this.errDivisionDero(),this.scrollDown()}}}),this}errDivisionDero(){const e="Error";this.equalResult==="Infinity"&&(this.equalResult=null,this.$primaryScreen.innerHTML=e)}updatePrimaryScreen(){this.varResult&&(this.$primaryScreen.innerText=this.varResult[this.varResult.length-1])}updateOperationsScreen(){this.varOperationResult[0]&&(this.$operationsScreen.innerText=this.varOperationResult[this.varOperationResult.length-1])}updateAllScreen(){this.updatePrimaryScreen(),this.updateOperationsScreen()}clearScreens(e){const t=document.querySelector('[data-clear="ac"]');e.clear==="ac"?(this.countAC+=1,this.countAC===1&&(console.warn("$bntAC",t.innerHTML),this.varResult.pop(),this.varOperationResult.pop(),this.equalResult=null,this.updatePrimaryScreen(),this.varOperationResult[0]||(this.fnLastHistoryScreen().innerText=""),!this.varOperationResult[0]&&!this.varResult[0]&&this.$operationsScreen.innerText!==""&&(this.countAC+=1)),this.countAC===2&&this.clearAll(),this.countAC>=3&&(this.$operationsScreen.innerHTML="<span></span>",this.clearAll())):this.countAC=0,this.varResult[0]||this.equalResult?t.innerHTML="C":!this.varOperationResult[0]&&!this.varResult[0]&&(t.innerHTML="AC"),console.error("this.countAC =",this.countAC)}equalLastNum(){this.varResult.length>=2&&this.symbolsMathRegex.test(this.varResult[this.varResult.length-1])&&(this.varResult.push(this.varResult[this.varResult.length-2]),this.varOperationResult.push(this.varResult[this.varResult.length-2]))}addingBrackets(){let e="",t,r=[!1,!1];this.varOperationResult.forEach((s,i)=>{this.varOperationResult[i]=s.replace(/\(+|\)+/,"");//! Del All Bracket ( )!
["×","÷"].includes(s)&&(r[0]=!0,console.log("statusAllOperators[0] = ",r[0])),["+","–"].includes(s)&&(r[1]=!0,console.log("statusAllOperators[1] = ",r[1])),r[0]===!0&&r[1]===!0&&(t=!0),console.log("status = ",t)}),t&&this.varOperationResult.forEach((s,i)=>{["×","÷"].includes(s)&&(!this.varOperationResult[i-2]||["+","–"].includes(this.varOperationResult[i-2]))&&(this.varOperationResult[i-1]=this.varOperationResult[i-1].replace(/^/,"("),e="(",console.error("item = ",s),console.log("status = ",t)),["+","–"].includes(s)&&e==="("&&(!this.varOperationResult[i-2]||["×","÷"].includes(this.varOperationResult[i-2]))&&(this.varOperationResult[i-1]=this.varOperationResult[i-1].replace(/$/,")").replace(/\)\)$/,")"),e=")",console.error("item = ",s),console.log("status = ",t))})}closeBracket(e){let t="";this.varOperationResult.forEach((r,s)=>{/\(/.test(r)?t="(":/\)/.test(r)&&(t=")"),t==="("&&e.equal==="="&&s===this.varOperationResult.length-1&&(this.varOperationResult[this.varOperationResult.length-1]=this.varOperationResult[this.varOperationResult.length-1].replace(/$/,")").replace(/\)\)$/,")"),console.log("this.varOperationResult",this.varOperationResult))})}delLastNumber(e){e.clearone==="c"&&this.varResult[0]&&(console.log("BTN C-One"),console.log("this.varOperationResult",this.varOperationResult),this.varResult[this.varResult.length-1]=this.varResult[this.varResult.length-1].slice(0,-1).replace(/-$/,""),this.varResult[this.varResult.length-1]===""&&(this.varResult.pop(),this.varOperationResult.pop(),this.varResult[0]||(this.varOperationResult=[],this.fnLastHistoryScreen().innerHTML="<span></span>")))}allFormatNumberForDisplay(e){this.numNegative(this.varResult),this.numNegative(this.varOperationResult),this.zeroDot(e,this.varResult),this.zeroDot(e,this.varOperationResult),this.addingBrackets(),this.zeroDotZeroFix()}zeroDotZeroFix(){this.varOperationResult[1]&&/[,\.]0+$/.test(this.varOperationResult[this.varOperationResult.length-2])&&(this.varOperationResult[this.varOperationResult.length-2]=this.varOperationResult[this.varOperationResult.length-2].replace(/[,\.]0+$/,""))}mathOperations(){function e(s){const i=[],a=[],p={"+":1,"–":1,"×":2,"÷":2};for(const o of s)if(!isNaN(Number(o)))a.push(Number(o));else if(["+","–","×","÷"].includes(o)){for(;i.length>0&&p[i[i.length-1]]>=p[o];){const h=i.pop(),c=a.pop(),m=a.pop();a.push(t(m,c,h))}i.push(o)}else return null;for(;i.length>0;){const o=i.pop(),h=a.pop(),c=a.pop();a.push(t(c,h,o))}return a.length!==1?null:a[0]}function t(s,i,a){switch(a){case"+":return s+i;case"–":return s-i;case"×":return s*i;case"÷":return s/i;default:return NaN}}const r=e(this.varResult);if(isNaN(r))console.error("Помилка обчислення");else{let s=this.fnToFixed(r)+"";return this.equalResult=s,console.warn("this.equalResult",this.equalResult),console.warn("typeof this.equalResult",typeof this.equalResult),s}}fnToFixed(e){if(typeof e=="number"){let t=+e.toFixed(this.limitNumbers);if(t=+t.toPrecision(this.limitNumbers-3),/[\.,]/.test(t+"")){let r=t+"".replace(/\.$/,"").replace(/0+$/,"");t=+r,r=t+"".replace(/0+$/,"").replace(/[\.,]$/,"").replace(/0+$/,""),t=+r}return t}}symbolsToDot(e){const r=e.toString().split(".");if(r.length===2){const i=r[0].length+1;if(i<this.limitNumbers)return this.limitNumbers-i}else return this.limitNumbers}renderScreen(e){if(this.varOperationResult[0]&&(this.$primaryScreen.innerHTML=this.addSpacesToNumber(this.varResult[this.varResult.length-1])),this.symbolsNumRegex.test(this.varResult[this.varResult.length-1])){this.varOperationResult[this.varOperationResult.length-1]=this.addSpacesToNumber(this.varResult[this.varResult.length-1]);//!=====================================
this.closeBracket(e);//!=====================================
}else this.varResult[0]||(this.$primaryScreen.innerText="0");this.varOperationResult[0]&&(this.fnLastHistoryScreen().innerHTML=this.varOperationResult.join(" ").replace(/(\d)\s+(\d)/g,"$1&nbsp;$2"));//!======
e.equal==="="&&this.renderActionEqualBtn(),this.preLastHistoryLine()}renderActionEqualBtn(){this.varResult.length>=3&&this.symbolsNumRegex.test(this.varResult[this.varResult.length-1])&&this.varResult&&(this.countHistoryResults+=1,this.mathOperations(),this.equalResult==="Infinity"?this.$operationsScreen.insertAdjacentHTML("beforeend",`
        <span class="res-equal res-equal-line">Error</span>
        `):this.$operationsScreen.insertAdjacentHTML("beforeend",`
      <span class="res-equal res-equal-line">${this.addSpacesToNumber(this.equalResult)}</span>
      `),this.$operationsScreen.insertAdjacentHTML("beforeend",`
      <span class="history">
      </span>`),this.equalResult==="Infinity"?this.$primaryScreen.innerText=this.equalResult:this.$primaryScreen.innerText=this.addSpacesToNumber(this.equalResult),this.scrollDown(),this.varResult=[],this.varOperationResult=[])}scrollDown(){this.$operationsScreen.scrollTo(0,document.body.scrollHeight)}preLastHistoryLine(){const e=document.querySelectorAll("#operations-screen span");e.forEach((t,r)=>{t.classList.contains("res-equal")&&e[r-1].classList.add("equal-line")})}clickEqual(){const e=document.querySelector('[data-equal="="]');console.error("$equalBtn",e),e.click()}btnMplus(e){const t=document.querySelector(".calc__m-screen"),r=()=>{this.mPlusMemory&&(this.mPlusMemory=this.fnToFixed(this.mPlusMemory)),console.error("this.mPlusMemory",this.mPlusMemory),(this.mPlusMemory||this.mPlusMemory===0)&&(t.style.opacity="1",t.innerHTML=this.addSpacesToNumber(`<span>M</span> &nbsp ${this.mPlusMemory}`),t.innerText!==""?t.style.opacity="1":t.style.opacity="0")};(()=>{e.m==="m+"&&(this.varResult.length>=2&&!this.equalResult?(this.clickEqual(),this.mPlusMemory=this.mPlusMemory+Number(this.equalResult)):this.varResult.length===1&&!this.equalResult?this.mPlusMemory=this.mPlusMemory+Number(this.varResult[this.varResult.length-1]):this.equalResult&&(this.mPlusMemory=this.mPlusMemory+Number(this.equalResult)),r()),e.m==="m-"&&(this.varResult.length>=2&&!this.equalResult?(this.clickEqual(),this.mPlusMemory=this.mPlusMemory-Number(this.equalResult)):this.varResult.length===1&&!this.equalResult?this.mPlusMemory=this.mPlusMemory-Number(this.varResult[this.varResult.length-1]):this.equalResult&&(this.mPlusMemory=this.mPlusMemory-Number(this.equalResult)),r())})()}mClear(e){const t=document.querySelector(".calc__m-screen");e.m==="mc"&&(this.mPlusMemory=null,t.innerText="",t.style.opacity="0")}mRecall(e){e.m==="mr"&&this.mPlusMemory&&(this.symbolsNumRegex.test(this.varResult[this.varResult.length-1])&&this.varResult[0]?(this.varResult.pop(),this.varOperationResult.pop(),this.varResult.push(this.mPlusMemory+""),this.varOperationResult.push(this.mPlusMemory+"")):this.symbolsMathRegex.test(this.varResult[this.varResult.length-1])&&this.varResult[0]?(this.varResult.push(this.mPlusMemory+""),this.varOperationResult.push(this.mPlusMemory+"")):this.varResult[0]||(this.varResult.push(this.mPlusMemory+""),this.varOperationResult.push(this.mPlusMemory+""))),this.renderScreen(e)}mScreenStyles(){const e="m-sceen-on",t=document.querySelector(".calc__m-screen");t.textContent!==""?t.classList.add(e):t.textContent===""&&t.classList.remove(e)}lastNumInResult(){let e="";return this.symbolsNumRegex.test(this.varResult[this.varResult.length-1])&&(e=this.varResult[this.varResult.length-1]),e}lastIndex(e){return e[e.length-1]}zeroDot(e,t){t[0]&&(t[t.length-1]==="."||t[t.length-1]===","?t[t.length-1]="0"+t[t.length-1]:t[t.length-1]==="00"&&(t[t.length-1]="0"),t[t.length-1]=t[t.length-1].replace(/^0([1-9])/,"$1").replace(/^-0([1-9])/,"-$1")),/[\.\,]$/.test(t[t.length-2])&&(t[t.length-2]=t[t.length-2].replace(/[\.\,]$/,""),this.$primaryScreen.innerHTML=this.addSpacesToNumber(this.varResult[this.varResult.length-2])),/[\.\,]$/.test(t[t.length-1])&&e.equal==="="&&(t[t.length-1]=t[t.length-1].replace(/[\.\,]$/,""))}numNegative(e){e[0]&&/-$/.test(e[e.length-1])&&(e[e.length-1]=e[e.length-1].replace(/-$/,""),e[e.length-1]="-"+e[e.length-1],e[e.length-1]==="-"&&(e[e.length-1]=e[e.length-1]+"0")),e[0]&&/^-\-+/.test(e[e.length-1])&&(e[e.length-1]=e[e.length-1].replace(/-+/,""))}addSpacesToNumber(e){let[t,r]=e.split(".");t=t.replace(/\B(?=(\d{3})+(?!\d))/g," ");//! ставить пробіли "1 234 000.5678"
t=t.replace(/^[.,]/,"0$&");let s=r?`${t},${r}`:t;return(this.lastIndex(e.toString())==="."||this.lastIndex(e.toString())===",")&&(s+=","),s}}class g{constructor(e){l(this,"$btn");l(this,"$btnsContainer");l(this,"$container");l(this,"$screenContainer");l(this,"$primaryScreen");this.$btn=document.querySelector(e.btn),this.$btnsContainer=document.querySelector(e.btnsContainer),this.$container=document.querySelector(e.container),this.$screenContainer=document.querySelector(e.screenContainer),this.$primaryScreen=document.querySelector(e.primaryScreen)}autoBorderRadiusInCalc(){const e=window.getComputedStyle(this.$btnsContainer),t=this.$btn.clientHeight,r=parseFloat(e.getPropertyValue("padding"));return this.$container.style.borderRadius=t/2+r+"px",this}adaptiveFSScreen(){const e=parseFloat(getComputedStyle(this.$screenContainer).paddingLeft),t=parseFloat(getComputedStyle(this.$screenContainer).paddingRight),r=this.$screenContainer.offsetWidth-e-t-5;console.log("widthContainer",r);let s=parseInt(window.getComputedStyle(this.$primaryScreen).fontSize);for(;this.$primaryScreen.offsetWidth>r&&s>=20;)s-=1,this.$primaryScreen.style.fontSize=`${s}px`;for(;this.$primaryScreen.offsetWidth<r&&s<=87.5;)s+=1,this.$primaryScreen.style.fontSize=`${s}px`;return y(),this}btnsTouch(){this.$btnsContainer.addEventListener("touchstart",e=>{const t=e.target;if(t.className.includes("button")){//! Android Vibration
t.closest(".button")&&navigator.vibrate&&navigator.vibrate(75)}let r="",s=t.className;s.includes("button__m")&&(r="#737371"),s.includes("button__control")&&(r="#D9D9D9"),s.includes("button__number")&&(r="#737373"),s.includes("button__math")&&(r="#F3C895"),t.style.backgroundColor=r,t.style.transition="background-color 0s, opacity 0.5s, transform 0.2s"},!1),this.$btnsContainer.addEventListener("touchend",function(e){const t=e.target;t.style.transition="background-color 0.5s, opacity 0.5s, transform 0.2s",setTimeout(function(){t.style.backgroundColor=""},20)},!1)}}const y=()=>u.scrollDown(),u=new d("#buttonsCalc",{limitNumbers:13});u.clickBtns();const R=new g({btn:"[data-equal]",btnsContainer:"#buttonsCalc",container:".calc",screenContainer:".calc__screen",primaryScreen:"#primary-screen"});R.autoBorderRadiusInCalc().adaptiveFSScreen().btnsTouch();const b=document.querySelector("#buttonsCalc");b.addEventListener("click",()=>{R.adaptiveFSScreen(),console.warn("calc.varResult",u.varResult),console.warn("calc.varOperationResult",u.varOperationResult),console.warn("calc.equalResult",u.equalResult),console.warn("calc.lastNumInResult()",u.lastNumInResult()),console.warn("calc.lastNumInResult()",u.countHistoryResults)});
