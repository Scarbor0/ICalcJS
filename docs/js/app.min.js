(()=>{"use strict";const t=new class{constructor(t,i){this.options=i,this.$el=document.querySelector(`#${t}`),this.$digit=document.querySelector("[data-digit]"),this.$buttonAC=document.querySelector("[data-clear]"),this.$buttonsMath=document.querySelectorAll("[data-math]"),this.negativeCount=1,this.equalCount=1,this.numA="",this.symbol="",this.numB="",this.resultAB="",this.returnAorB="",this.statuslastDot=!1,this.numberAfterDot=null,this.statusnoNumBEqualNumA=!1,this.digitCopy="",this.arrDigigt=["0"]}buttonACContent(){""!==this.numA||""!==this.numB?this.$buttonAC.innerHTML="C":""!==this.numA&&""!==this.numB||(this.$buttonAC.innerHTML="AC")}buttonAC(){"ac"===this.targetDataSet.clear&&(this.clearVars(),console.warn("AC clear!"))}clearVars(){this.$digit.innerHTML="0",this.numA="",this.numB="",this.symbol="",this.resultAB="",this.returnAorB="",this.negativeCount=1,//!
this.equalCount=1,this.statuslastDot=!1,this.statusnoNumBEqualNumA=!1,this.mathBtnsClearActive()}clearOneSymbol(){if("c"===this.targetDataSet.clearone&&""!==this.returnAorB){this.mathBtnsClearActive();const t=()=>{this.digitRender(this.$digit.innerHTML.slice(0,-1)),this.numA=this.$digit.innerHTML,this.returnAorB=this.$digit.innerHTML},i=()=>{this.digitRender(this.$digit.innerHTML.slice(0,-1)),this.numB=this.$digit.innerHTML,this.returnAorB=this.$digit.innerHTML};""===this.symbol&&""===this.numB&&("."===this.lastIndex(this.$digit.innerHTML)&&(this.statuslastDot=!1,this.digitRender(this.$digit.innerHTML.slice(0,-1)),this.numberAfterDot=null,this.numB.slice(0,-1)),t()),""!==this.numA&&""!==this.symbol&&("."===this.lastIndex(this.$digit.innerHTML)&&(this.statuslastDot=!1,this.digitRender(this.$digit.innerHTML.slice(0,-1)),this.numberAfterDot=null),i()),""!==this.numA&&""!==this.numB||""===this.$digit.innerHTML&&this.digitRender("0")}}AorB(t,i){"string"==typeof this.targetDataSet.number&&""===this.symbol&&""===this.numB&&("="===i&&this.nextNumber(1,t,"="),"+"===i&&this.nextNumber(1,t,"+"),this.mathBtnsClearActive()),"string"==typeof this.targetDataSet.number&&""!==this.numA&&""!==this.symbol&&("="===i&&this.nextNumber(2,t,"="),"+"===i&&this.nextNumber(2,t,"+"),this.mathBtnsClearActive())}numbersEntryAorB(){this.AorB(this.targetDataSet.number,"+"),console.error("numAB() "+this.numAB())}mathBtnsClearActive(){for(let t of this.$buttonsMath){function i(){t.classList.remove("button__math-active")}i()}}symbolEntry(){this.equalCount>1&&"string"==typeof this.targetDataSet.math&&(this.numB=""),""!==this.numA&&"string"==typeof this.targetDataSet.math&&(this.equalCount=1,this.statusnoNumBEqualNumA=!1,this.symbol=this.targetDataSet.math,this.mathBtnsClearActive(),this.target.classList.toggle("button__math-active"),"."===this.lastIndex(this.$digit.innerHTML)&&this.digitRender(this.$digit.innerHTML.replace(/\.$/d,"")))}numAB(){return""===this.symbol?this.numA:this.numB}returnVarAB(t){this.numA===this.numAB()?this.numA=t:this.numB===this.numAB()&&(this.numB=t)}nextNumber(t,i,s){switch(t){case 1://! ================================== case 1 ================================
this.fixMultiZero(this.numA),1===t&&"="===s&&(this.numA=i),1===t&&"+"===s&&(this.numA+=i),this.digitRender(this.numA),this.fixDots(),this.removeLastDot(),this.returnAorB=this.numA;break;case 2://! ================================== case 2 ================================
this.fixMultiZero(this.numB),2===t&&"="===s&&(this.numB=i),2===t&&"+"===s&&(this.numB+=i),this.fixDots(),this.digitRender(this.numB),this.returnAorB=this.numB}}fixMultiZero(t){"0"===t[0]&&"."!==t[1]&&(""!==this.numA&&""===this.numB&&(this.numA=this.numA.slice(1)),""!==this.numB&&(this.numB=this.numB.slice(1)))}lastIndex(t){return t[t.length-1]}fixDots(){this.returnVarAB(this.numAB().replace(/-[^.\d]+/g,"").replace(/^([^\.]*\.)|\./g,"$1")),this.digitRender(this.$digit.innerHTML.replace(/-[^.\d]+/g,"").replace(/^([^\.]*\.)|\./g,"$1")),"."===this.lastIndex(this.$digit.innerHTML)&&this.options.includes(this.targetDataSet.math)&&this.digitRender(this.$digit.innerHTML.replace(/\.$/d),"")}removeLastDot(){console.error("this.statuslastDot "+this.statuslastDot),"."===this.lastIndex(this.numAB())&&(this.statuslastDot=!0,this.AorB(this.numAB().replace(/\.$/d,""),"="),this.digitRender(this.numAB()+".")),!0===this.statuslastDot&&"."!==this.lastIndex(this.numAB())&&"."!==this.targetDataSet.number&&"-"!==this.targetDataSet.number&&(console.error("this.statuslastDot "+this.statuslastDot),this.statuslastDot=!1,this.numberAfterDot=this.lastIndex(this.numAB()),this.AorB(this.numAB().replace(/.$/d,"."+this.numberAfterDot),"="),2===this.numAB().length&&"."===this.numAB()[0]&&this.AorB(0+this.numAB(),"="),console.error("this.statuslastDot + NUM "+this.statuslastDot),console.error("this.numberAfterDot + NUM "+this.numberAfterDot)),""===this.numAB()&&!0===this.statuslastDot&&(this.AorB("0","="),this.digitRender("0.")),"string"==typeof this.targetDataSet.math&&(this.statuslastDot=!1)}buttonNegative(){"-"===this.lastIndex(this.numAB())&&this.AorB(this.numAB().replace(/-$/g,"").replace(/^/g,"-"),"="),"-"===this.numAB()&&this.AorB(this.numAB().replace(/$/g,"0"),"="),"-"===this.numAB()[0]&&"0"===this.numAB()[1]&&"."!==this.numAB()[2]&&"string"==typeof this.numAB()[2]&&this.AorB(this.numAB().replace(/^-0/g,"-"),"=")}buttonsEqual(){"."===this.lastIndex(this.numB)&&this.numB.replace(/\.$/d,""),""!==this.numA&&""!==this.symbol&&""!==this.numB&&(this.equalCount+=1,console.warn("method ="),console.error("equalCount = "+this.equalCount),console.error("buttonsEqual() numB "+this.numB),this.digitRender(this.resultAB),this.numA=this.resultAB)}clearAfterEqualPressNum(){if("string"==typeof this.targetDataSet.number&&this.equalCount>1){let t="";t+=this.targetDataSet.number,this.clearVars(),this.AorB(t,"+"),t="",console.error("cccccccccccccccccccccccccclearAfterEqualPressNum() this.equalCount "+this.equalCount)}}equalSymbol(){this.options.includes(this.targetDataSet.math)&&""!==this.numA&&""!==this.symbol&&""!==this.numB&&(console.error("includes"),this.numA=this.resultAB,this.digitRender(this.numA),this.numB="")}noNumBEqualNumA(){""!==this.numA&&""!==this.symbol&&""===this.numB&&"="===this.targetDataSet.equal&&(this.numB=this.numA,this.mathOperations(),this.numA=this.resultAB,this.digitRender(this.numA),this.statusnoNumBEqualNumA=!0,this.equalCount+=1,this.mathBtnsClearActive())}mathOperations(){if(console.warn("this.symbol "+this.symbol),""!==this.numA&&this.symbol&&""!==this.numB)switch(this.symbol){case"+":this.resultAB=Number(this.numA)+Number(this.numB),this.foFixedNumFloat();break;case"-":this.resultAB=Number(this.numA)-Number(this.numB),this.foFixedNumFloat();break;case"*":this.resultAB=Number(this.numA)*Number(this.numB),this.foFixedNumFloat();break;case"/":this.resultAB=Number(this.numA)/Number(this.numB),this.foFixedNumFloat()}}foFixedNumFloat(){let t=parseInt(this.$digit.innerHTML)+"";return t=t.length,this.resultdigitLengthFloat=this.$digit.innerHTML.length-t,this.resultdigitLengthFloat=this.resultdigitLengthFloat+"",this.$digit.innerHTML.includes(".")&&this.resultdigitLengthFloat,console.error("this.resultdigitLengthFloat "+this.resultdigitLengthFloat),console.error(this.resultdigitLengthFloat),this.resultAB=this.fnToFixed(this.resultAB)}fnToFixed(t){return t=parseFloat(t).toFixed(6).replace(/0+$/g,"").replace(/\.$/g,"")}fixDotWithoutZero(){"."===this.numA&&(this.numA="0.",this.digitRender("0."),this.returnAorB="0."),"."===this.numB&&(this.numB="0.",this.digitRender("0."),this.returnAorB="0.")}digitRender(t){this.$digit.innerHTML=t}blinkingDigit(){this.arrDigigt.push(this.$digit.innerHTML),this.arrDigigt=this.arrDigigt.slice(-2),console.log("this.arrDigigt",this.arrDigigt),this.arrDigigt[0]===this.arrDigigt[1]&&(this.$digit.style.opacity=0,setTimeout((()=>{this.$digit.style.opacity=1}),100))}trueAllVars(){if(""!==this.numA&&""!==this.numB&&""!==this.symbol)return!0}percentBtn(t){//! кнопки і операції => 10, %, =0.1 (numA = numA / 100)
document.querySelector("[data-equal]");"%"===t.dataset.percent&&(""!==this.numA&&""===this.numB?(""===this.symbol&&(this.numA=this.fnToFixed(this.numA/100),this.digitRender(this.numA)),"+"!==this.symbol&&"-"!==this.symbol||(//! кнопки і операції => 10, + or -, % (this.numB = this.numA / 100 * this.numA)
this.numB=this.fnToFixed(this.numA/100*this.numA),this.digitRender(this.numB),console.log("if percent",1)),"*"!==this.symbol&&"/"!==this.symbol||(//! кнопки і операції => 10, * or /, % (this.numB = this.numA / 100)
this.numB=this.fnToFixed(this.numA/100),this.digitRender(this.numB),console.log("if percent",2))):""!==this.numA&&""!==this.numB&&("+"!==this.symbol&&"-"!==this.symbol||(//! кнопки і операції => 50, + or -, 20, % (this.numB = this.numA / 100 * this.numB)
this.numB=this.fnToFixed(this.numA/100*this.numB),this.digitRender(this.numB),console.log("if percent",3)),"*"!==this.symbol&&"/"!==this.symbol||(//! кнопки і операції => 50, + or -, 20, % (this.numB = this.numA / 100 * this.numB)
this.numB=this.fnToFixed(this.numB/100),this.digitRender(this.numB),console.log("if percent",4))))}}("buttonsCalc",["ac","%","/","*","-","+"]);t.$el.addEventListener("click",(i=>{i.target.closest(".button")&&(t.targetDataSet=i.target.dataset,t.target=i.target,console.warn("press targetttttttttttttttttttttttttttttttt!!! "+t.targetDataSet),t.targetDataSet,t.symbolEntry(),t.numbersEntryAorB(),//! Запис числа 1 або 2
t.removeLastDot(),t.buttonNegative(),t.equalSymbol(),//! 1+2+3 FIX PROBLEM! OLD
"="===t.targetDataSet.equal&&t.buttonsEqual(),t.percentBtn(i.target),t.noNumBEqualNumA(),t.clearOneSymbol(),t.mathOperations(),//! Запуск математичної операції
t.buttonAC(),t.fixDotWithoutZero(),t.clearAfterEqualPressNum(),t.buttonACContent(),t.blinkingDigit(),
//! рперший нуль тільки один!
console.group("looooooooooooooooooooooooooooooooooooooooogs"),//! LOGS
console.warn("statuslastDot "+t.statuslastDot),console.warn("statusnoNumBEqualNumA "+t.statusnoNumBEqualNumA),console.warn("equalCount "+t.equalCount),console.log("numA = "+t.numA),console.log("symbol = "+t.symbol),console.log("numB = "+t.numB),console.log("resultAB = "+t.resultAB),console.log("equalCount = "+t.equalCount),console.log("returnAorB  "+t.returnAorB),console.log("numAB()  "+t.numAB()),console.warn("calc.negativeCount "+t.negativeCount),console.warn("last symbol in digit "+t.returnAorB[t.returnAorB.length-1]),console.warn("digitCopy ",t.digitCopy),console.warn("$digit ",t.$digit.innerHTML))})),window.FLS=!0,function(t){let i=new Image;i.onload=i.onerror=function(){t(2==i.height)},i.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(t){let i=!0===t?"webp":"no-webp";document.documentElement.classList.add(i)}))})();